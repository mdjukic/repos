
${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.economistcomprod
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
\" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_recent
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_history_19000101_20150831
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_history_20150901_20151231
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_history_20160101_20160214
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_history_20160215_20160531
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "


${sshprd01} "source ~/bigdataconfig.py; psql --host=\${redshifthostname} --port=\${redshiftport} --username=\${myredshiftusername} --dbname=\${myredshiftdbname} -c \"
UPDATE adobe.combined_table_history_20160601_20160930
SET referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_start_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
first_hit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
post_page_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),		   
post_pagename_no_url = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
url  = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid'),
visit_referrer = REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(referrer,
           'https://www.economist.com/users/.+%2540.+',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'https://www.economist.com/users/.+%2540.+/',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'user_search_advanced?.*&uid',
		   'user_search_advanced?DroppedEmailAddress&uid'),
		   '/unsubscribe?.*&h',
           '/unsubscribe?DroppedEmailAddress&h'),
           'gcs\\?ss=.*',
           'gcs?ss=DroppedEmailAddress'),
           'lastname=[^&](.*?)&',
           'lastname=DroppedName&'),
           'family_name=[^&](.*?)&',
           'family_name=DroppedName&'),
           'given_name=[^&](.*?)&',
           'given_name=DroppedName&'),
           'email=(.+)',
           'email=DroppedEmailAddress'),
           'https://www.economist.com/user\\?email.*&cid1',
           'https://www.economist.com/user?emailDroppedEmailAddress&cid1'),
           'destination=user%2F3383857%3Femail%(.+)cid1',
           'destination=user%2F3383857%3Femail%DroppedEmailAddresscid1'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'user_search_advanced%3Fmail%(.+)uid',
           'user_search_advanced%3Fmail%DroppedEmailAddressuid'),
           'destination=user%3Femail%(.+)cid1',
           'destination=user%3Femail%DroppedEmailAddresscid1'),
           'destination=search%2Fgcs%3Fss%(.+)',
           'destination=search%2Fgcs%3Fss%DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)',
           'https://www.economist.com/users/DroppedEmailAddress'),
           'https://www.economist.com/users/(.+)%40(.+)/',
           'https://www.economist.com/users/DroppedEmailAddress/'),
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid',
           'destination=admin%2Fec%2Fuser_search_advanced%3Fmail%DroppedEmailAddressuid')
WHERE ((referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (referrer LIKE '%user_search_advanced?.*&uid%')
OR     (referrer LIKE '%/unsubscribe?.*&h%')
OR     (referrer LIKE '%gcs\\?ss=.*%')
OR     (referrer LIKE '%lastname=[^&](.*?)&%')
OR     (referrer LIKE '%family_name=[^&](.*?)&%')
OR     (referrer LIKE '%given_name=[^&](.*?)&%')
OR     (referrer LIKE '%email=(.+)%')
OR     (referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (post_referrer LIKE '%/unsubscribe?.*&h%')
OR     (post_referrer LIKE '%gcs\\?ss=.*%')
OR     (post_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (post_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (post_referrer LIKE '%email=(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_start_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (visit_start_page_url LIKE '%/unsubscribe?.*&h%')
OR     (visit_start_page_url LIKE '%gcs\\?ss=.*%')
OR     (visit_start_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (visit_start_page_url LIKE '%email=(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_start_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_start_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_start_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_start_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_start_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_page_url LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_page_url LIKE '%gcs\\?ss=.*%')
OR     (first_hit_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_page_url LIKE '%email=(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (first_hit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (first_hit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (first_hit_referrer LIKE '%gcs\\?ss=.*%')
OR     (first_hit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (first_hit_referrer LIKE '%email=(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (first_hit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (first_hit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (first_hit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (first_hit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (first_hit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_page_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_page_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_page_url LIKE '%/unsubscribe?.*&h%')
OR     (post_page_url LIKE '%gcs\\?ss=.*%')
OR     (post_page_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_page_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_page_url LIKE '%email=(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_page_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_page_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_page_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_page_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_page_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (post_pagename_no_url LIKE '%user_search_advanced?.*&uid%')
OR     (post_pagename_no_url LIKE '%/unsubscribe?.*&h%')
OR     (post_pagename_no_url LIKE '%gcs\\?ss=.*%')
OR     (post_pagename_no_url LIKE '%lastname=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%family_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%given_name=[^&](.*?)&%')
OR     (post_pagename_no_url LIKE '%email=(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (post_pagename_no_url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (post_pagename_no_url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (post_pagename_no_url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (post_pagename_no_url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (url LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (url LIKE '%user_search_advanced?.*&uid%')
OR     (url LIKE '%/unsubscribe?.*&h%')
OR     (url LIKE '%gcs\\?ss=.*%')
OR     (url LIKE '%lastname=[^&](.*?)&%')
OR     (url LIKE '%family_name=[^&](.*?)&%')
OR     (url LIKE '%given_name=[^&](.*?)&%')
OR     (url LIKE '%email=(.+)%')
OR     (url LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (url LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (url LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (url LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (url LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (url LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/.+%2540.+/%')
OR     (visit_referrer LIKE '%user_search_advanced?.*&uid%')
OR     (visit_referrer LIKE '%/unsubscribe?.*&h%')
OR     (visit_referrer LIKE '%gcs\\?ss=.*%')
OR     (visit_referrer LIKE '%lastname=[^&](.*?)&%')
OR     (visit_referrer LIKE '%family_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%given_name=[^&](.*?)&%')
OR     (visit_referrer LIKE '%email=(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/user\\?email.*&cid1%')
OR     (visit_referrer LIKE '%destination=user%2F3383857%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%user_search_advanced%3Fmail%(.+)uid%')
OR     (visit_referrer LIKE '%destination=user%3Femail%(.+)cid1%')
OR     (visit_referrer LIKE '%destination=search%2Fgcs%3Fss%(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)%')
OR     (visit_referrer LIKE '%https://www.economist.com/users/(.+)%40(.+)/%')
OR     (visit_referrer LIKE '%destination=admin%2Fec%2Fuser_search_advanced%3Fmail%(.+)uid%') )
AND source = 'economist online' \" "

